

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>SQL Dialects &mdash; sqlr</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Column Naming Conventions" href="naming-conventions.html" />
    <link rel="prev" title="Extended SQL Format" href="sql-format.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> sqlr
          

          
          </a>

          
            
            
              <div class="version">
                0.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="queries.html">Performing Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="column-mapping.html">Column Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="sql-format.html">Extended SQL Format</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">SQL Dialects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-default-dialect">The default dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="#specifying-the-sql-dialect">Specifying the SQL dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-multiple-dialects">Using multiple dialects</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="naming-conventions.html">Column Naming Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="schema.html">The Schema Type</a></li>
<li class="toctree-l1"><a class="reference internal" href="sqlr-gen.html">Code Generation using sqlr-gen</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">Running the Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="prior-art.html">Prior Art</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">sqlr</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>SQL Dialects</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/dialects.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="sql-dialects">
<span id="dialects"></span><h1>SQL Dialects<a class="headerlink" href="#sql-dialects" title="Permalink to this headline">¶</a></h1>
<p>The <cite>sqlr</cite> package is designed to be as SQL-agnostic as possible, but
when it is generating SQL it does need to know the following:</p>
<ul class="simple">
<li>How to quote column names to ensure they are not interpreted as an SQL keyword<ul>
<li>PostgreSQL uses double quotes: <code class="docutils literal notranslate"><span class="pre">&quot;column_name&quot;</span></code></li>
<li>MySQL uses back ticks: <code class="docutils literal notranslate"><span class="pre">`column_name`</span></code></li>
<li>MS SQL Server uses square braces: <code class="docutils literal notranslate"><span class="pre">[column_name]</span></code></li>
</ul>
</li>
<li>How to write placeholders for arguments<ul>
<li>PostgreSQL uses numbered placeholders: <code class="docutils literal notranslate"><span class="pre">$1</span></code>, <code class="docutils literal notranslate"><span class="pre">$2</span></code>, etc</li>
<li>Almost everyone else uses question marks: <code class="docutils literal notranslate"><span class="pre">?</span></code></li>
</ul>
</li>
</ul>
<p>The following dialects are available out of the box:</p>
<ul class="simple">
<li>Postgres <em>(aka PostgreSQL)</em></li>
<li>MySQL</li>
<li>SQLite</li>
<li>MS SQL Server</li>
<li>ANSI SQL</li>
</ul>
<p>Preparing a new dialect is possible, by implementing the
<a class="reference external" href="https://godoc.org/github.com/jjeffery/sqlr#Dialect">sqlr.Dialect</a>
interface.</p>
<div class="section" id="the-default-dialect">
<h2>The default dialect<a class="headerlink" href="#the-default-dialect" title="Permalink to this headline">¶</a></h2>
<p>Most programs use only one SQL driver, and in these circumstances <cite>sqlr</cite>
will do the right thing.</p>
<p>For example, if a program is using Postgres, it will need to load the appropriate driver,
probably in the <cite>main</cite> package:</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nx">_</span> <span class="s">&quot;github.com/lib/pq&quot;</span>
</pre></div>
</div>
<p>By default <cite>sqlr</cite> will check the list of loaded SQL drivers and pick the
first one to decide on the SQL dialect to use. If only one SQL driver has been
loaded, it will choose correctly. In this example it will automatically choose
the “postgres” dialect.</p>
</div>
<div class="section" id="specifying-the-sql-dialect">
<h2>Specifying the SQL dialect<a class="headerlink" href="#specifying-the-sql-dialect" title="Permalink to this headline">¶</a></h2>
<p>If your program references multiple SQL drivers, it is necesary to
specify which dialect is in use. This can be done when opening the
database connection:</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// open the database</span>
<span class="nx">db</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">sql</span><span class="p">.</span><span class="nx">Open</span><span class="p">(</span><span class="s">&quot;postgres&quot;</span><span class="p">,</span> <span class="s">&quot;user=test dbname=test sslmode=disable&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
  <span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// create the schema</span>
<span class="nx">schema</span> <span class="o">:=</span> <span class="nx">sqlr</span><span class="p">.</span><span class="nx">NewSchema</span><span class="p">(</span>
  <span class="nx">sqlr</span><span class="p">.</span><span class="nx">WithDialect</span><span class="p">(</span><span class="nx">sqlr</span><span class="p">.</span><span class="nx">Postgres</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="using-multiple-dialects">
<h2>Using multiple dialects<a class="headerlink" href="#using-multiple-dialects" title="Permalink to this headline">¶</a></h2>
<p>If your program makes use of multiple database connections with different
types of server, the best thing to do is to specify a <code class="docutils literal notranslate"><span class="pre">sqlr.Schema</span></code>
for each of the databases:</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">postgres</span> <span class="p">=</span> <span class="nx">sqlr</span><span class="p">.</span><span class="nx">NewSchema</span><span class="p">(</span>
  <span class="nx">sqlr</span><span class="p">.</span><span class="nx">WithDialect</span><span class="p">(</span><span class="nx">sqlr</span><span class="p">.</span><span class="nx">Postgres</span><span class="p">),</span>
<span class="p">)</span>

<span class="kd">var</span> <span class="nx">mysql</span> <span class="p">=</span> <span class="nx">sqlr</span><span class="p">.</span><span class="nx">NewSchema</span><span class="p">(</span>
  <span class="nx">sqlr</span><span class="p">.</span><span class="nx">WithDialect</span><span class="p">(</span><span class="nx">sqlr</span><span class="p">.</span><span class="nx">MySQL</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<p>When the time comes to create statements, use the appropriate schema:</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// insert widgets in postgres database</span>
<span class="nx">err</span> <span class="p">=</span> <span class="nx">postgres</span><span class="p">.</span><span class="nx">Insert</span><span class="p">(</span><span class="nx">db1</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">widget</span><span class="p">,</span> <span class="s">&quot;widgets&quot;</span><span class="p">)</span>

<span class="c1">// update statement for gadgets in mysql database</span>
<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">mysql</span><span class="p">.</span><span class="nx">Update</span><span class="p">(</span><span class="nx">db2</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">gadget</span><span class="p">,</span> <span class="s">&quot;gadgets&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="naming-conventions.html" class="btn btn-neutral float-right" title="Column Naming Conventions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="sql-format.html" class="btn btn-neutral" title="Extended SQL Format" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, John Jeffery.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.5',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>