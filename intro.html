

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Introduction &mdash; sqlr</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Performing Queries" href="queries.html" />
    <link rel="prev" title="sqlr – SQL package" href="index.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> sqlr
          

          
          </a>

          
            
            
              <div class="version">
                0.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installing">Installing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#source-code">Source Code</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="queries.html">Performing Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="column-mapping.html">Column Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="sql-format.html">Extended SQL Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="dialects.html">SQL Dialects</a></li>
<li class="toctree-l1"><a class="reference internal" href="naming-conventions.html">Column Naming Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="schema.html">The Schema Type</a></li>
<li class="toctree-l1"><a class="reference internal" href="sqlr-gen.html">Code Generation using sqlr-gen</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">Running the Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="prior-art.html">Prior Art</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">sqlr</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Introduction</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/intro.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>Package <cite>sqlr</cite> is designed to reduce the effort required to implement
common operations performed with SQL databases. It is intended for programmers
who are comfortable with writing SQL, but would like assistance with the
sometimes tedious process of preparing SQL queries for tables that have a
large number of columns, or have a variable number of input parameters.</p>
<p>This package is designed to work seamlessly with the standard library
“database/sql” package. It does not provide any layer on top of <cite>*sql.DB</cite>
or <cite>*sql.Tx</cite>. If the calling program has a need to execute queries independently
of this package, it can use “database/sql” directly, or make use of any other
third party package that uses “database/sql”.</p>
<p>The following features are provided to simplify writing SQL database queries:</p>
<dl class="docutils">
<dt>Prepare SQL from row structures</dt>
<dd><p class="first">It is error-prone and tedious to write SQL queries with long lists of column
names and placeholder variables. Package sqlr provides a way to map column lists
in the SQL with a Go language structure. The result is a way to write concise
SQL queries even for tables with large number of columns:</p>
<div class="last highlight-go notranslate"><div class="highlight"><pre><span></span><span class="nx">schema</span><span class="p">.</span><span class="nx">Exec</span><span class="p">(</span><span class="nx">db</span><span class="p">,</span> <span class="nx">row</span><span class="p">,</span> <span class="s">&quot;insert into table_name({}) values({})&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Autoincrement column values</dt>
<dd><p class="first">When inserting rows, if a column is defined as an autoincrement column, then the
generated value will be retrieved from the database server, and the corresponding
field in the row structure will be updated:</p>
<div class="last highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">type</span> <span class="nx">Row</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">Id</span>         <span class="kt">int</span>     <span class="s">`sql:&quot;primary key autoincrement&quot;`</span>
    <span class="nx">GivenName</span>  <span class="kt">string</span>
    <span class="nx">FamilyName</span> <span class="kt">string</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
<dt>Null columns</dt>
<dd><p class="first">Package sqlr provides a convenient mechanism to map NULL values in the database to
the equivalent empty value in the Go struct field, for example mapping NULL to zero
for integer values, or NULL to the empty string for string values. This is not always
applicable as NULL and the empty string are not necessarily the same thing, but in many
cases there is no ambiguity, and the result is simpler, smaller code:</p>
<div class="last highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">type</span> <span class="nx">Row</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="c1">// ... lots of other fields and then ...</span>

    <span class="nx">PhoneNumber</span> <span class="kt">string</span>  <span class="s">`sql:&quot;null&quot;`</span> <span class="c1">// stores NULL for empty string</span>
    <span class="nx">FaxNumber</span>   <span class="kt">string</span>  <span class="s">`sql:&quot;null&quot;`</span>
    <span class="nx">AddressID</span>   <span class="kt">int</span>     <span class="s">`sql:&quot;null&quot;`</span> <span class="c1">// stores NULL for zero</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
<dt>JSON columns</dt>
<dd><p class="first">A convenient mechanism for marshaling complex objects as JSON text for storage in
an SQL database is supported:</p>
<div class="last highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">type</span> <span class="nx">Row</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="c1">// ... lots of other fields and then ...</span>

    <span class="nx">Cmplx</span>  <span class="o">*</span><span class="nx">MyComplexDataStructure</span> <span class="s">`sql:&quot;json&quot;`</span> <span class="c1">// will be stored as JSON text</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
<dt>WHERE IN Clauses with multiple values</dt>
<dd><p class="first">When an SQL query contains a <cite>WHERE IN</cite> clause, it usually requires additional string
manipulation to match the number of placeholders in the query with args.
This package simplifies queries with a variable number of arguments: when processing
an SQL query, it detects if any of the arguments are slices and adjusts the query
accordingly:</p>
<div class="last highlight-go notranslate"><div class="highlight"><pre><span></span><span class="nx">id</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">int</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">}</span>
<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">schema</span><span class="p">.</span><span class="nx">Select</span><span class="p">(</span><span class="nx">db</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">rows</span><span class="p">,</span> <span class="s">`select {} from widgets where id in (?)`</span><span class="p">,</span> <span class="nx">ids</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Code generation</dt>
<dd>The <cite>sqlr-gen</cite> command is provided to help with generating repetitive code.</dd>
</dl>
<div class="section" id="installing">
<h2>Installing<a class="headerlink" href="#installing" title="Permalink to this headline">¶</a></h2>
<p>To obtain a copy of the <cite>sqlr</cite> package, use <code class="docutils literal notranslate"><span class="pre">go</span> <span class="pre">get</span></code>:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>go get github.com/jjeffery/sqlr
</pre></div>
</div>
<p>Note that additional setup is required if you wish to run the tests
against database servers. The setup required is discussed in <a class="reference internal" href="tests.html#tests"><span class="std std-ref">Running the Tests</span></a>.</p>
</div>
<div class="section" id="source-code">
<h2>Source Code<a class="headerlink" href="#source-code" title="Permalink to this headline">¶</a></h2>
<p>The source code is available at <a class="reference external" href="https://github.com/jjeffery/sqlr">https://github.com/jjeffery/sqlr</a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="queries.html" class="btn btn-neutral float-right" title="Performing Queries" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="sqlr – SQL package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, John Jeffery.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.5',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>